% This is the Reed College LaTeX thesis template. Most of the work
% for the document class was done by Sam Noble (SN), as well as this
% template. Later comments etc. by Ben Salzberg (BTS). Additional
% restructuring and APA support by Jess Youngberg (JY).
% Your comments and suggestions are more than welcome; please email
% them to cus@reed.edu
%
% See http://web.reed.edu/cis/help/latex.html for help. There are a 
% great bunch of help pages there, with notes on
% getting started, bibtex, etc. Go there and read it if you're not
% already familiar with LaTeX.
%
% Any line that starts with a percent symbol is a comment. 
% They won't show up in the document, and are useful for notes 
% to yourself and explaining commands. 
% Commenting also removes a line from the document; 
% very handy for troubleshooting problems. -BTS

% As far as I know, this follows the requirements laid out in 
% the 2002-2003 Senior Handbook. Ask a librarian to check the 
% document before binding. -SN

%%
%% Preamble
%%
% \documentclass{<something>} must begin each LaTeX document
\documentclass[12pt,twoside]{reedthesis}
% Packages are extensions to the basic LaTeX functions. Whatever you
% want to typeset, there is probably a package out there for it.
% Chemistry (chemtex), screenplays, you name it.
% Check out CTAN to see: http://www.ctan.org/
%%
\usepackage{graphicx,latexsym} 
\usepackage{amssymb,amsthm}
\usepackage{longtable,booktabs,setspace} 
\usepackage[hyphens]{url}
\usepackage{rotating}
\usepackage{natbib}
\usepackage{hyperref}
\usepackage{outlines}
\usepackage{bbm, stmaryrd, mathrsfs}
\usepackage{luatexja} % for memes
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{braket}
\hypersetup{
  colorlinks,
  allcolors=black,
  hidelinks,
}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{joke}{Joke}
\newtheorem{notation}{Notation}

\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem{recall}{Recall}


\theoremstyle{plain}
\newtheorem{theorem}{Theorem}

\include{autodelims}
\include{macros}

% Comment out the natbib line above and uncomment the following two lines to use the new 
% biblatex-chicago style, for Chicago A. Also make some changes at the end where the 
% bibliography is included. 
% \usepackage{biblatex-chicago}
% \bibliography{thesis}

% \usepackage{times} % other fonts are available like times, bookman, charter, palatino

\title{慣性ドリフト: From 0 to Normalization by Gluing in 4.9 seconds\\ A Brisk Drift through Categorical Semantics of Lambda Calculi}
\author{Jay Kruer}
% The month and year that you submit your FINAL draft TO THE LIBRARY (May or December)
\date{December 2021}
\division{Mathematics and Natural Sciences}
\advisor{Ang\'elica Osorno}
\altadvisor{James (Jim) Fix}

% If you have two advisors for some reason, you can use the following
% \altadvisor{Your Other Advisor}
%%% Remember to use the correct depart*** 
\department{Mathematics}
% if you're writing a thesis in an interdisciplinary major,
% uncomment the line below and change the text as appropriate.
% check the Senior Handbook if unsure.
% \thedivisionof{The Established Interdisciplinary Committee for}
% if you want the approval page to say "Approved for the Committee",
% uncomment the next line
% \approvedforthe{Committee}

\setlength{\parskip}{0pt}
%%
%% End Preamble
%%
%% The fun begins:
\begin{document}

\maketitle
\frontmatter % this stuff will be roman-numbered
\pagestyle{empty} % this removes page numbers from the frontmatter

% Acknowledgements (Acceptable American spelling) are optional
% So are Acknowledgments (proper English spelling)
\chapter*{Acknowledgements}
My parents, Jaclyn, Nick Chaiyachakiorn, Ms. Kim, Hyong Rhew, Mrs. Leitsch, Mr. Raveli (was that his name? gotta find out
somehow), Jim Fix, Ang\'elica Osorno, Irena Swanson, Kyle Ormsby, Amal Ahmed,

% The preface is optional
% To remove it, comment it out or delete it.
\chapter*{Preface}
This is an example of a thesis setup to use the reed thesis document class.



\chapter*{List of Abbreviations}
You can always change the way your abbrevias are formatted. Play around with it yourself, use tables, or come to CUS if you'd like to change the way it looks. You can also completely remove this chapter if you have no need for a list of abbreviations. Here is an example of what this could look like:

\begin{table}[h]
  \centering % You could remove this to move table to the left
  \begin{tabular}{ll}
    \textbf{ABC}  	&  American Broadcasting Company \\
    \textbf{CBS}  	&  Columbia Broadcasting System\\
    \textbf{CDC}  	&  Center for Disease Control \\
    \textbf{CIA}  	&  Central Intelligence Agency\\
    \textbf{CLBR} 	&  Center for Life Beyond Reed\\
    \textbf{CUS}  	&  Computer User Services\\
    \textbf{FBI}  	&  Federal Bureau of Investigation\\
    \textbf{NBC}  	&  National Broadcasting Corporation\\
  \end{tabular}
\end{table}


\tableofcontents
% if you want a list of tables, optional
\listoftables
% if you want a list of figures, also optional
\listoffigures

% The abstract is not required if you're writing a creative thesis (but aren't they all?)
% If your abstract is longer than a page, there may be a formatting issue.
\chapter*{Abstract}
The preface pretty much says it all.

\chapter*{Dedication}
You can have a dedication here if you wish.

\mainmatter% here the regular arabic numbering starts
\pagestyle{fancyplain} % turns page numbering back on

% The \introduction command is provided as a convenience.
% if you want special chapter formatting, you'll probably want to avoid using it altogether

\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}
\chaptermark{Introduction}
\markboth{Introduction}{Introduction}
% The three lines above are to make sure that the headers are right, that the intro gets included in the table of contents, and that it doesn't get numbered 1 so that chapter one is 1.

% Double spacing: if you want to double space, or one and a half 
% space, uncomment one of the following lines. You can go back to 
% single spacing with the \singlespacing command.
% \onehalfspacing
% \doublespacing

Welcome to the \LaTeX\ thesis template. If you've never used \TeX\ or \LaTeX\ before, you'll have an initial learning period to go through, but the results of a nicely formatted thesis are worth it for more than the aesthetic benefit: markup like \LaTeX\ is more consistent than the output of a word processor, much less prone to corruption or crashing and the resulting file is smaller than a Word file. While you may have never had problems using Word in the past, your thesis is going to be about twice as large and complex as anything you've written before, taxing Word's capabilities. If you're still on the fence about  using \LaTeX, read the Introduction to LaTeX on the CUS site as well as skim the following template and give it a few weeks. Pretty soon all the markup gibberish will become second nature.

\chapter{Basic Type Theory}
\chapter{Enough Categories to Get Working}
\chapter{Sus semantics of type theory: sketches and their models; algebraic theories and their algebras}

% TODO
% adopt doctrine terminology throughout 
% Cite Sterling/Gratzer somewhere
% Cite Wells outline
% rework for a more modern and diagrammatic take on sketches?
% 


% General thoughts on this chapter: Considerable rework is probably advised. Paul
% Taylor's book follows basically this progression: 1\) introduce the concept of an
% elementary sketch 2\) generalize the concept of elementary sketch to the concept
% of algebraic theory, which can encode familiar types of object like the theory
% of rings; 3\) build a (not-quite? we have function types in the lambda calculus;
% such sorts aren't specifically mentioned in the doctrine of algebraic theories)
% algebraic theory of the lambda calculus and talk about its models in cartesian
% closed categories. I have spent a great deal of my writing time trying to figure
% out how to make the first step work—limiting yourself to unary operations makes
% providing concrete examples surprisingly challenging—but I am beginning to think
% it's not even necessary. I am eager to get the first chapter finished soon so I
% can turn my attention to some of the stuff I'm planning to draw on in later
% chapters about gluing for normalization proofs.

In this chapter we develop the semantics of type theory by categorical methods
using \emph{sketches}. The reader familiar with and/or traumatized by experience
with pencils of geodesics in hyperbolic geometry need not be scared away by our
terminology; there is nothing non-Euclidean afoot here, even if we are building
our way to some nominally geometric notions. We will introduce two
\emph{doctrines}; or, notions of \emph{synactic theories}. A \emph{doctrine} is
something like a meta-framework specifying how we are to write down a notion of
abstract structure. For example, the doctrine of \emph{algebraic theories}
allows us to write down what it means to be a ring---without any reference to sets
or functions---as we will see later in this chapter (TODO: Cite
https://ncatlab.org/nlab/revision/doctrine/19). In the following chapter, we
will scale up our doctrine to one able to encode the \emph{cartesian closed
  structure} of the lambda calculus (TODO: actually correct?). We begin with the
notion of an \emph{elementary sketch}, which is powerful enough to describe
theories with unary operations (something \emph{like} single-variable functions)
and multiple \emph{sorts} (which you may, for now, regard as a type, set,
object, etc.) The \emph{doctrine} of elementary sketches is somewhat limited; it
only allows us to define theories employing only the structure guaranteed by an
ordinary category, without any guaranteed products, limits, etc; elementary
sketches work for defining associative theories with identity. This should make
the reader think of monoids, and we will reward that strong recall with an
example sketch of a monoid in due course. With their multiple sorts, sketches
also allow us to encode structures not frequently encountered in an algebra
course, such as finite automata. Later we will generalize the doctrine of
elementary sketches to that of \emph{algebraic theories}. Algebraic theories are
known more famously as \emph{Lawvere theories} after categorical logic and model
theory superstar (and former Reed College professor!) William Lawvere. Keeping
with our sketchy terminology, they are also called \emph{finite product
  sketches}. \emph{Algebraic theories} allow for operations over any finite
number of inputs and so grow the capabilities of our development to encoding
more grotesque mathematical artifacts than monoids. This chapter is strictly
expository in nature. Much of the following presentation draws heavily from Paul
Taylor's \emph{Practical Foundations of Mathematics}
(\cite{taylor_practical_1999}.) Our humble contribution is to flesh out some of
his examples, add some of our own, and make parts of the presentation more
palatable and quickly digestible to the reader already acquainted with basic
category theory and type theory.

\section{Elementary sketches and their models}
\subsection{An algebraic prelude}
We begin by recalling from algebra the notion of an \emph{action} of, say, a
group or a monoid. Actions are, from our perspective, a way of giving meaning,
or \emph{semantics} to elements of a set enjoying some algebraic structure.
\begin{definition}\label{def:covariant action}
  Recall that a \textbf{covariant action} of a group or monoid \((M, id, \cdot)\) on a
  set \(A\) is a binary operation \((-)_* (=) : M ‌\times A \rightarrow A\) such that
  \(\text{id}_* a = a\) and \( (g \circ f)_* a = g_* (f_* a) \). We can similarly a
  define the notion of a \textbf{contravariant action} which acts in the order
  opposite of that in the composition.
\end{definition}
[TODO: reword much of this paragraph; not great writing here]
For example, in algebra we learn that the dihedral group of order 8, written
$D_{4}$, acts on the square (with uniquely identified points) by reflections and
rotations (TODO: cite https://groupprops.subwiki.org/wiki/Dihedral\_group:D8);
each of the operations encoded by the action results in the same image of the
square up to ignoring the unique identity of the points we started with. This
action gives geometric meaning to each of the group elements, and was even used
in the first day of the author's algebra class to explain the algebraic
mechanics of the group itself; discovering which elements of the group cancel
each other out is done by geometric experimentation using a square with uniquely
colored vertices. Similarly, the symmetric groups $S_{n}$ act on lists of length
$n$ by permutation of the list elements. In this case, the action can be even
more trivially defined. We now turn to the definition of a property of actions:
\emph{faithfulness}.

\begin{definition}\label{def:faithful}
  A \textbf{faithful} action $(-)_{*}$ is one for which things
  are semantically equal (or, act the same) only when they are syntactically
  equal (or, are the same as far as your eyeballs are concerned.) More precisely
  rendered, we require: \[ \forall (a:A)\ldotp f_* a = g_* a \Longrightarrow f = g \]
\end{definition}

It can now be seen that the critical property enjoyed by the natural action of
$D_{8}$ which enabled our use of cute little square cutouts is faithfulness. If
the action were not faithful, determining which operations in $D_{8}$ are
inverses would not be so easy as printing out a square and plugging away,
because we may have an action which may not take only the identity element to
the leave-everything-in-place action on the square.


Having gesticulated that actions gives groups and monoids their meaning, we turn
to the development of some new notions that will allow us to generalize both the
notion of algebraic structures and their actions to new
settings. % TODO: fix this phrasing
The corresponding notions are, respectively, sketches and their models.

\subsection{Elementary sketches}
As promised, we begin with the notion of an \emph{elementary sketch} which
allows us to encode structures involving \emph{unary} operations.
\begin{definition}\label{def:elem sketch}
  An \textbf{elementary sketch} is comprised of the following data:
  \begin{enumerate}
    \item a collection \(X, Y, Z, \dots \) of named \textbf{base types} or
          \textbf{sorts}
    \item a \textbf{variable} \(x:X\) for each occurrence of each named sort.
    \item a collection of \textbf{unary operation-symbols} or
          \textbf{constructors} \(\tau\) having at most one variable. As a
          clarifying example: when sketching type theories, we will write
          \( x:X \vdash \tau(x) : Y \).
    \item a collection of equations or \textbf{laws} of the
          form: \[ \tau_n (\tau_{n-1}(\cdots \tau_2 (\tau_1 (x))\cdots )) = \sigma_m (\sigma_{m-1}(\cdots \sigma_2 (\sigma_1 (x))\cdots )) \]
  \end{enumerate}
\end{definition}
We will discuss the generality provided by this definition after some
intervening examples. One of the simplest examples is the sketch of a monoid on some set $S$:

\begin{example}[Sketch of a (free) monoid]\label{ex:monoid sketch}
  The requisite data for the sketch are as follows:
  \begin{enumerate}
    \item The collection of sorts is the singleton \( \{M\} \).
    \item The collection of variables is \( \{m:M\} \).
    \item The collection of operation symbols is the set \( S \). Each has as its signature \( M \rightarrow M \)
    \item No equations are imposed.
  \end{enumerate}
\end{example}

To really buy that this sketch generates a free monoid, we begin with an
intervening definition of a notion we will get a lot of mileage out of in this
thesis.
\begin{definition}\label{def:term}
  Given an elementary sketch, a \textbf{term} $x : \Gamma \vdash X$ is a string of
  composable unary operation-symbols applied to a variable $\gamma : \Gamma$ as in:
  \( \tau_{n} (\tau_{n-1} (\cdots (\tau_{2}(\tau_{1}(\gamma))))) \). Composable unary-operation
  symbols are ones which have compatible domains and codomains in the usual
  sense as in set theory.
\end{definition}
We now propose a more precise version of the above claim: the terms of the
sketch defined above form the elements of a free monoid \( S \). Before we can
continue, we should decide what the composition should look like. The definition
of composition of terms is by substitution: for a term \( \sigma : \Delta \vdash \Gamma\) and some
terms \( \tau_{i}\) with \( \tau_{n} : \cdots \vdash X \) we define
\[ (\tau_{n} (\tau_{n-1} (\cdots (\tau_{2}(\tau_{1}(\gamma)))))) \circ \sigma = \tau_{n} (\tau_{n-1} (\cdots (\tau_{2}(\tau_{1}(\sigma(\delta)))))) : \Delta \vdash X \].
The reader will recall from our early discussions of basic type theory that
substitution is associative [TODO]; our sketch gets that monoid axiom for free. The
identity term is given by zero composable unary operation-symbols applied to a
variable. It's just a variable; when composing the identity with a term of the
appropriate type, we end up getting exactly that term [TODO: say more here, or maybe
flesh this out.]

  [TODO: transition to discussion of models]
  %   The definition of an elementary sketch allows for multiple \emph{sorts}. All
  % the common examples from algebra which we have seen so far only make use of a
  % single sort; in particular, all strings of elements of the sketches we've
  % looked at so far are composable. For an example of a structure for which this
  % is not the case, and therefore one where the notion of sketch gives us a new
  % opportunity for formalization, we shall turn to an example drawing from the
  % theory of finite automata in computability theory. [TODO: finite automata
  % example here.]

  % To really begin to buy that this sketch encodes the free monoid on the set S,
  % it helps to consider a \emph{model}, which is in some sense a way of giving a
  % sketch meaning in terms of the ambient mathematical universe.

  % TODO: rework to be an algebra of algebraic theory
  \begin{definition}\label{def:model}
    A \textbf{model} (also known as an algebra, an interpretation, a covariant
    action) of an elementary sketch is comprised of:
    \begin{enumerate}
      \item an assignment of a set $A_X$ to each sort $X$ and
      \item an assignment of a function $\tau_* : A_X \rightarrow A_Y$ for each
            operation-symbol of the appropriate arity such that:
      \item each law is preserved; i.e., for each law as before we have
            \[ {\tau_n}_* ({\tau_{n-1}}_* (\cdots {\tau_2}_* ({\tau_1}_* (x))\cdots )) = {\sigma_m}_* ({\sigma_{m-1}}_*(\cdots {\sigma_2}_* ({\sigma_1}_* (x))\cdots )) \]
            that is, the covariant action on operation-symbols is faithful in
            the sense defined above.
    \end{enumerate}
  \end{definition}

  % We now will continue by giving the free monoid sketch a model:
  % \begin{example}
  %   \begin{enumerate}
  %     \item To the single sort \( M \) we assign the set \( S \)
  %     \item To the operation symbols \( s \in S \), we assign the function
  %           \( S \rightarrow S \) which takes \( t \in S\) to \( s \cdot t \); namely, it acts
  %           by left-multiplication.
  %     \item The laws are vacuosly preserved.
  %   \end{enumerate}
  % \end{example}
  % TODO: rework to algebraic theory
  \begin{definition}\label{def:clone}
    Given an elementary (unary) sketch, the \textbf{clone} at \( (\Gamma, X) \) is
    the set \( \text{Cn}_\mathcal{L} (\Gamma, X) \) of all the \textbf{terms} of sort
    $X$ assuming a single variable of sort $\Gamma$, quotiented by the laws of the
    sketch.
  \end{definition}
  The fact that a sketch's clones contain \emph{equivalence classes} of its
  terms will feature prominently in our later study of ideas central to the
  goals of this thesis. In particular, clones alone don't allow for any
  meaningful discussion of computational behavior of terms undergoing reduction;
  a term's normal form and its various reducible forms are identified in the
  clone.

  It can be shown that the clones of a sketch form (the sets for) a model of a
  sketch. In particular, it can be shown that the sketch acts covariantly on the
  set of its clones:
  \begin{theorem}\label{thm:clone model}
    Every elementary sketch has a faithful covariant action on its clones
    \(\mathcal{H}_{X} = \cup_{\Gamma} \text{Cn}_{\mathcal{L}}(\Gamma,X)\) by sequencing with
    the operation symbol. Substitution for the (single) variable in a term gives
    a faithful contravariant action on
    \(\mathcal{H}^{Y} = \cup_{\Theta} \text{Cn}_{\mathcal{L}}(Y,\Theta)\).
  \end{theorem}
  \begin{proof}
    The actions of \(\tau : X \rightarrow Y\) on
    \(\text{Cn}_\mathcal{L}(\Gamma,X) \subseteq \mathcal{H}_{X}\) and
    \(\text{Cn}_\mathcal{L}(Y,\Theta) \subseteq \mathcal{H}^{Y}\) are given by:
    \begin{itemize}
      \item \(\tau_{*}a_{n}(\cdots a_{2}(a_{2}(\sigma))\cdots) =
      \tau(a_{n}(\cdots(a_{2}(a_{1}(\sigma))))) \in
      \text{Cn}_{\mathcal{L}}(\Gamma,Y)\)
      \item \(\tau_{*}\zeta_{m}(\cdots \zeta_{2}(\zeta_{1}(y))) =
      \zeta_{m}(\cdots\zeta_{2}(\zeta_{1}(\tau(x)))) \in
      \text{Cn}_{\mathcal{L}}(X,\Theta)\)
    \end{itemize}
    where \(\sigma : \Gamma, x : X, \text { and }, y:Y\). Covariance of the
    former is clear. Contravariance of the latter follows by considering the
    behavior of substitutions in sequence.
  \end{proof}

  Recalling our sketch of a monoid from Example \ref{ex:monoid sketch}, the substance of
  this covariant action morally amounts to saying that the monoid acts on itself
  by left multiplication (here ``multiplication'' is actually just juxtaposition
  plus some parentheses). This is essentially ``the same'' action that groups
  enjoy as guaranteed by Cayley's theorem.

  \begin{joke}
    A couple of type theorists walk into a Michelin starred restaurant. The menu
    reads in blackboard bold letters $\mathbbm{``NO\, SUBSTITUTIONS''}$. They promptly leave.
  \end{joke}

% TODO: I nuked this whole section. I'm not sure it's really worth covering, and
% anyway, I didn't like what I had here.

% \section{Models and their categories; and, categories and their models}
% Despite not enjoying many compelling examples, elementary sketches are
% interesting due to their close resemblence to categories in their most basic
% form. With no extra structural requirements, it turns out that every elementary
% sketch gives rise to a category, and even more surprisingly, that every

% \begin{theorem}[Every elementary sketch gives rise to a category]\label{thm:sketch cat}
%   TODO
% \end{theorem}

% \begin{theorem}[Every category gives rise to a canonical elementary sketch]\label{thm:canon lang}
%   TODO
% \end{theorem}

% % TODO: mention the canonical elementary language for a category?: this
% % justifies the whole treatment of elementary sketches; every category gives
% % rise to an elementary sketch, while only some (those with finite products)
% % give rise to an algebraic theory.

% % TODO: The title of this chapter is sort of wrong. There is a correspondence between
% % categories and elementary sketches, but not the other way around; *a* model
% % gives rise to *a* category associated with a sketch, but going the other way
% % seems non-obvious to me.

\subsection{The category of contexts and substitutions}
We now introduce a very special category. This category is special in both the
structure it enjoys as well as the central role it will play in the rest of the
thesis. This category goes by many names: \emph{syntactic category}, the (rather
verbose) \emph{category of contexts and substitutions}, and the elusive
\emph{classifying category}. We endeavor to explain the meaning behind each of
these names over the course of the thesis, but for now we adopt the name most
closely describing its presentation.

\newcommand{\id}{\text{id}} % TODO: move this

\begin{definition}[The category of contexts and substitutions]\label{def:syn cat}
  Given a sketch $\mathcal{L}$, the \textbf{category of contexts and substitutions}, written \( \text{Cn}^{\times}_{\mathcal{L}}\) is presented as follows:
  \begin{outline}
    \1 The objects are the contexts of \( \mathcal{L} \) namely finitely lists
    of distinct variables and their types.

    \1 The generating morphisms are:

      \2 Single substitutions or \emph{declarations} \( [a/x] : \Gamma \rightarrow [\Gamma, x:X] \) for each term
      \( \Gamma \vdash a : X \). The direction here should be confusing unless you're already an expert.

      \2 Single omissions or \emph{drops} \( \hat{x} : [\Gamma, x : X] \rightarrow \Gamma \) for
      each variable $x:X$.

    \1 The laws are given by an extended version of the familiar substitution
      lemma from type theory. The following laws are added for each collection
      of terms $a,b$ and distinct variables $x$ and $y$ such that $x$ does not
      appear free in $a$ and $y$ appears free in neither $a$ or $b$:
    \begin{align*}
      % declaration follow by drop does nothing
      [a/x] ; \hat{x} &= \id \\
      % successive declarations commute up to accounting for the first
      % declaration in the body of the second
      [a/x] ; [b/y]   &= [ [ a/x ]^{*} b/y ] ; [a/x] \\
      % non-overlapping declarations and drops commute
      [a/x]; \hat{y} &= \hat{y}; [a/x] \\
      % non-overlapping drops commute
      \hat{x}; \hat{y} &= \hat{y}; \hat{x} \\
      % assigning y to a variable, dropping it, then re-assigning that variable
      % to refer to y gives y := y. dropping y then results in the identity.
      [x/y]; \hat{x}; [y/x]; \hat{y} &= \id
    \end{align*}
  \end{outline}
  We will briefly speak to the meaning of the laws. The first law says that
  binding a variable to some term and then forgetting the variable is just the
  same as doing nothing. The second law says that successive variable
  declarations commute \emph{up to accounting for the first declaration in the
    body of the second}. The third law says that \emph{non-overlapping}
  declarations and drops commute. The fourth law says that pairs of
  non-overlapping drops commute. The last law is slightly more tricky and
  requires taking careful account of the free variables in play. [TODO: return
  to this] 
\end{definition}

\subsection{Models are essentially functors with the right codomain}
\newcommand{\clone}[3]{{\text{Cn}_{#1}(#2,#3)}}
\newcommand{\cn}{\mathrm{Cn}}
\begin{theorem}[The classifying category]\label{thm:classify_elem_sketch}
  Let $\mathcal{L}$ be an elementary sketch and \( \cn_{\mathcal{L}} \) the
  category it presents. Then the interpretations of $\mathcal{L}$ correspond to
  functors $\cn_{\mathcal{L}} \rightarrow \mathfrak{Set}$.
\end{theorem}
\begin{proof}
  Omitted. We will give the proof for a more general result in
  \ref{thm:classifying alg theory}.
\end{proof}


\subsection{Example morphisms in the syntactic category}
A natural question for the operationally-minded reader to ask after having seen
the definition of the syntactic category is: how does all this ornate structure
encode terms in the calculus I'm interested in? Let us ask instead a more
precise question: how do we represent by a substitution a term \(\Gamma \vdash t : T\)?
For such a term, there is a canonical substitution (morphism of contexts)
\( \Gamma \xrightarrow[]{[t/x]} \Gamma,x:X \) which ``picks'' that term in X. Here $[t/x]$
is an explicit encoding/formula for the substitution inserting $t$ anywhere it
sees $x$. The ordering of the codomain and domain here are confusing, but the
contravariant base change functor, which lifts this encoding to a real
substitution \emph{operation} clarifies things; we have:
\( [t/x]^{*} : \clone{}{\Gamma, x:X}{T} \longrightarrow \clone{}{\Gamma}{T} \). In words, the
substitution operation takes a term of type $T$ under $\Gamma$ and an additional free
variable $x:X$ and gives us a term of type $T$ under just $\Gamma$; we reduce our
assumption set by filling in one of the assumptions with some concrete evidence,
namely the (syntactic) term $t$. In the special case of a closed (syntactic)
term $t$, we have \( [t/x]^{*} : \clone{}{x:X}{T} \longrightarrow \clone{}{\emptyset}{T}\).

\section{Algebraic theories and their algebras}
Having defined elementary sketches, which give us a way to define multi-sorted
theories, it's obvious to request the ability to define multi-input operations.
Algebraic theories, having their genesis in the work of William Lawvere,
generalize elementary sketches and allow us to do so.
\begin{definition}[Algebraic theory]\label{def:alg theory}
  A (finitary many-sorted) \textbf{algebraic theory} $\mathcal{L}$ has
  \begin{enumerate}
    \item a collection of base types of \textbf{sorts}, $X$: We write $\Sigma$ for the set of these sorts;
    \item an inexhaustible collecting of variables $x_{i}:X$ of each sor;
    \item a collection of \textbf{operation symbols}, $X_{1},\dots , X_{k} \vdash r : Y$ each having an \textbf{arity}, namely a list of input sorts $X_{i}$, and an output sort $Y$; and
    \item a collection of \textbf{laws}, posed as equalities between different
          terms (in the sense defined before)
  \end{enumerate}
\end{definition}
Here's a little known statistic: One in two readers of this draft will note that
the notion of Lawvere theory can be rephrased in terms of operards; Lawvere
theories are operads for which the tensor product used in forming the operation
domains happens to be the plain ol' Cartesian product \cite{TODO: Nlab}.

The next major concept we will introduce generalizes to algebraic theories the
notion of \emph{action} or \emph{model} we saw previously for elementary
sketches. As expected, the definition will be essentially the same up to taking
some products. Before doing so, we will give an intervening example of an
algebraic theory.
\begin{example}[Algebraic theory of \emph{ring}]\label{ex:theory of ring}

  We sketch an algebraic theory encoding the familiar structure of a ring from
  abstract algebra. The presentation should be familiar to anyone with a
  background in abstract algebra, except that we force the existence of
  multiplicative and additive identities by requiring any instance of this
  theory to provide \emph{global elements}, namely operations over a
  distinguished sort $\mathbbm{1}$.
  \begin{enumerate}
    \item Sorts: \( \mathbbm{1}, S, S, S \). The variables for each sort are
          \( \square \) and \( x, y, z\) respectively.

    \item Operations: \begin{align*}
                        \cdot &: S \times S \rightarrow S, \\
                        + &: S \times S \rightarrow S,\\
                        0 &: \mathbbm{1} \rightarrow S,\\
                        1 &: \mathbbm{1} \rightarrow S,\\
                        - &: S \rightarrow S
                      \end{align*}

    \item Laws: \begin{align*}
                  +(x,y) &= +(y,x)\\
                  +(0(\square), x) &= x\\
                  +(x, -(x)) &= 0(\square)\\
                  \cdot(x,y) &= \cdot(y,x)\\
                  \cdot(1(\square), x) &= x\\
                  \cdot(x, +(y,z)) &= +(\cdot(x,y), \cdot(x,z))
                \end{align*}
  \end{enumerate}
\end{example}

Having given the obligatory concrete example, we now have permission to proceed
with another abstract definition: that of an \emph{$\mathcal{L}$-algebra} for an
algebraic theory:

\begin{definition}[$\mathcal{L}$-algebra]\label{def:algebra}
  Given an algebraic theory $\mathcal{L}$ and a category $C$ with finite
  products (in the sense of the universal property as treated in the chapter on
  basic category theory) an \emph{$\mathcal{L}$-algebra in $C$} is comprised of
  \begin{enumerate}
    \item an object $A_{X}$ of $C$ for each sort $X$ of $\mathcal{L}$, and
    \item for each operation symbol $X_{1}, \dots , X_{k} \vdash r : Y$, an
          assignment of a map \(r_{A} : A_{X_{1}} \times \cdots \times A_{X_{k}} \rightarrow A_{Y}\) in
          $C$.
  \end{enumerate}
  such that the assignments respect the laws of $\mathcal{L}$.
\end{definition}

We now give an example of an algebra (in the category of sets) for the theory of
a ring given in \ref{ex:theory of ring}.
\begin{example}\label{ex:integer ring}
  TODO: do we need to deal with explicating the product structure in this
  example? see taylor's monoid example in 4.6
  \begin{enumerate}
    \item For the sorts, we set $A_{S} = \mathbb{Z}$ and $A_{\mathbbm{1}} = \{\star\}$
    \item For the operations, we set
    \begin{enumerate}
      \item $\cdot_A = *$ where $*$ is the ordinary multiplication of integers
      \item $+_{A} = +$ where the second plus is ordinary addition of integers
      \item $0_{A}$ to the constant function $x \mapsto 0 \in \mathbb{Z}$
      \item $1_{A}$ to the constant function $x \mapsto 1 \in \mathbb{Z}$
      \item $-_{A}$ to the function $x \mapsto -x$ taking an integer to its additive inverse
    \end{enumerate}
    \item We wouldn't dare bore the reader by verifying all the laws, so we
          demonstrate just one. We show that the $0$ selected by the model
          indeed serves as the left identity of addition in the model.
          \begin{proof}
            \begin{align*}
              +_{A} \circ \braket{0_{A}, \id} &= (x : \{ \star \}, y : \mathbb{Z}) \mapsto 0_{A}(x) + \id(y)\\
                                          &= (x : \{ \star \}, y : \mathbb{Z}) \mapsto 0_{\mathbb{Z}} + y \\
                                          &= (x : \{ \star \}, y : \mathbb{Z}) \mapsto y
                                          &= \id_{\mathbbm{1}_{Z} \times S_{A}} \\
            \end{align*}

            Our proof is almost done, but we must justify that the final
            identity morphism is actually the interpretation of the variable
            $x$. This fact will be validated by results later in this section.
            In particular, we will give a proper treatment to the interpretation
            of terms in an algebraic theory and observe the equivalence of the
            terms $x$ and $\hat{\square} x$ (recall that $\square$ is the variable we
            settled on for the sort $\mathbbm{1}$) just as in our construction
            of the syntactic category for an elementary sketch. With the
            clearing of that remaining goalpost promised, we have shown what is
            required for this law.
          \end{proof}
  \end{enumerate}
\end{example}

The reader familiar with algebra will observe that this example (at least when
fully worked out by a less lazy typist) amounts to verifying that the integers
form a ring under the standard multiplication and addition operations we learn
in elementary school. A natural next question to ask is how we might encode a
ring homomorphism in this framework. To answer this question, we (of course)
define a more general notion:

\begin{definition}[$\mathcal{L}$-algebra homomorphism]\label{def:homomorphism}
  A \emph{homomorphism} \( A \rightarrow B\) of $\mathcal{L}$-algebras $A$ and $B$ in some
  finite-productful category $C$ is an assignment to each sort $X$ of a
  $C$-morphism \( \phi_{X} : A_{X} \rightarrow B_{X}\) between the corresponding options
\end{definition}

\begin{remark}
  Of course, the $\mathfrak{C}$-valued algebras and homomorphisms of an algebraic
  theory $\mathcal{L}$ form a category, called
  $\mathscr{Mod}_{\mathfrak{C}}(\mathcal{L})$. TODO: prove it, nerd.
\end{remark}

Most questions in type theory are concerned with the \emph{terms} of the theory
at hand. Normalization theorems talk about the accessibility (under some
reduction relation) of a certain class of terms from any arbitrary term.
Canonicity, a stronger property implying normalization, talks about the
accessibility of another more strict class of terms from arbitrary start terms.
These are but two examples of a broad spectrum of properties one might desire of
the terms of a theory. Considering the primacy of term properties in type
theory, it is rather strange that the notion of semantics we have built so far
makes no commentary on terms. Our models so far have only given meaning to the
\emph{sorts} (types) and /emph{operation symbols} (constructors) of the theory
considered. In fact, this is enough: our models extend canonically to contexts
and substitutions and thus give meaning to terms.

\DeclarePairedDelimiter{\sem}{\llbracket}{\rrbracket}

\begin{definition}[Extending a model to terms]\label{def:term model}
  Let $A$ be an $\mathcal{L}$-algebra in a category $\mathfrak{C}$ This algebra
  extends canonically to an interpretation $\sem{-}$ of contexts by the
  following definition recursive in the structure of contexts:
  \begin{align}
    \label{eq:contexts interp}
    \sem{} &= \mathbbm{1}_{C} \\
    \sem{\Gamma, x : X} &= \sem{\Gamma} \times A_{X}
  \end{align}
  The (overly) careful reader will complain that $\mathfrak{C}$ doesn't
  necessarily feature a terminal object, but it turns out that a terminal object
  is guaranteed by the finite product closure we imposed on $\mathfrak{C}$ in
  our definition of algebras; we are good to go.

  Recalling more from the definition of an algebra, we know that $A$ gives
  meaning to each operation symbol \( Y_{1},\dots , Y_{k} \vdash r : Z \) as a
  morphism \( r_{A} : A_{Y_{1}} \times \cdots \times A_{Y_{k}} \rightarrow A_{Z} \) and gives meaning to
  each constant \( c : Z \) by a morphism \( 1_{\mathfrak{C}} \rightarrow A_{Z} \). We can
  extend this uniquely to arbitrary terms in the context
  \( \Gamma \equiv \sem{x_{1} : X_{1}, \dots , x_{n} : X_{n}} \) by the following
  recursive definiton:
  \begin{align}
    \label{eq:term interp}
    \sem{x_{i}} &: \sem{\Gamma} \equiv A_{X_{1}} \times \cdots \times A_{X_{n}} \xrightarrow{\pi_{i}} A_{X_{i}} \\
    \sem{c} &: \sem{\Gamma} \xrightarrow{<_{!}} \mathbbm{1}_{C} \xrightarrow{c_{A}} A_{Z} \\
    \sem{r(u_{1}, \dots , u_{k})} &: \sem{\Gamma} \xrightarrow{\braket{\sem{u_{1}}, \dots, \sem{u_{k}}}} A_{Y_{1}} \times \cdots \times A_{Y_{k}} \xrightarrow{r_{A}} A_{Z}
  \end{align}
  where the $\sem{u_{i}}$ are the interpretations of the sub-expressions of the
  expression in the final line, $\pi_{i}$ is the $i$th projection guaranteed to us
  by the universal property of products, and $<_{!}$ is the unique map into the
  terminal object. The angle bracket notion is used to express the product
  functor's action on morphisms in $\mathfrak{C}$. For clarity, we write out
  explicitly the composites for the reader:
  \begin{align*}
    \sem{x_{i}} &\equiv \pi_{i} \\
    \sem{c} &\equiv c_{A } \circ <_{!} \\
    \sem{r(u_{1}, \dots , u_{k})} &\equiv r_{A} \circ \braket{\sem{u_{1}}, \dots,\sem{u_{k}}}
  \end{align*}
\end{definition}

\begin{theorem}[The classifying category of an algebraic
  theory]\label{thm:classifying alg theory} Let \( \mathcal{L} \) be an
  algebraic theory. Then \begin{enumerate}
    \item $\cn_\mathcal{L}^{\times}$ has finite products and an $\mathcal{L}$-algebra.
    \item Let $\mathfrak{C}$ be another category with a choice of finite
    products and an $\mathcal{L}$-algebra. Then the functor $\sem{-} :
    \cn_{\mathcal{L}}^{\times} \rightarrow \mathfrak{C}$ preserves finite
    products and the $\mathcal{L}$-algebra, and is the unique such functor.
    \item Any functor \( \cn_{\mathcal{L}}^{\times} \rightarrow C \) which
    preserves finite products also preserves the $mathcal{L}$-algebra.
  \end{enumerate}
\end{theorem}
\newcommand{\ob}{\mathrm{ob}\,}
\begin{proof}\,\\
  \begin{enumerate}
    \item We first show that the syntactic category has finite products. Recall
    that the objects of the syntactic category are variable contexts \([x : X, y
    : Y, z : Z, \dots]\). For any other context \( [t : T, u : U, v : V, \dots]
    \) we have the product \[ [x : X, y : Y, z : Z, \dots] \times [t : T, u : U,
    v : V] = [x : X, y : Y, z : Z, \dots, t : T, u : U, v : V, \dots]\] That
    is, products are given by concatenation of contexts. Now the model is given
    as follows:
    \begin{enumerate}
      \item The sorts $X$ of $\mathcal{L}$ are interpreted as single variable
      contexts $[x:X] \in \ob C$ where the variable $x$ is arbitrary.
      \item The operation symbols \( X_1, X_2, \dots \vdash r : Y \) of
      $\mathcal{L}$ are interpreted as substitutions \( [r(x_1, x_2, \dots)/y] :
      [x_1:X_1, x_2:X_2,\dots] \rightarrow [y : Y]\) 
    \end{enumerate}
    \item The functor promised is precisely the one defined by Definition
          \ref{thm:term model}. TODO: we still need to verify the uniqueness of
          this functor, which Taylor himself never demonstrates.
          \item This result demands a full proof, which isn't given in Taylor.
          \begin{proof}
            Suppose we have a functor $F : \cn_{\mathcal{L}}^{\times} \rightarrow \mathfrak{C}$
            which preserves products. We will show that it preserves the
            $\mathcal{L}-model$. In particular, it takes the intrepretation in
            $\cn_{\mathcal{L}}^{\times}$ of any context $\Gamma$ to the intrepretation of
            $\Gamma$ in $\mathfrak{C}$.
          \end{proof}



  \end{enumerate}
\end{proof}


\section{Sketching the simply typed lambda calculus}


\chapter{Enough Topoi to Grok Glueing}
\chapter{Grokking Glueing}
\chapter{Glueing for Normalization}

\chapter*{Conclusion}
\addcontentsline{toc}{chapter}{Conclusion}
\chaptermark{Conclusion}
\markboth{Conclusion}{Conclusion}
\setcounter{chapter}{4}
\setcounter{section}{0}

That's it for now.

% If you feel it necessary to include an appendix, it goes here.
\appendix
\chapter{The First Appendix}
\chapter{The Second Appendix, for Fun}


% This is where endnotes are supposed to go, if you have them.
% I have no idea how endnotes work with LaTeX.

\backmatter% backmatter makes the index and bibliography appear properly in the t.o.c...

% if you're using bibtex, the next line forces every entry in the bibtex file to be included
% in your bibliography, regardless of whether or not you've cited it in the thesis.
\nocite{*}

% Rename my bibliography to be called "Works Cited" and not "References" or ``Bibliography''
% \renewcommand{\bibname}{Works Cited}

% \bibliographystyle{bsts/mla-good} % there are a variety of styles available;
% \bibliographystyle{plainnat}
% replace ``plainnat'' with the style of choice. You can refer to files in the bsts or APA 
% subfolder, e.g. 
\bibliographystyle{APA/apa-good}  % or
\bibliography{thesis}
% Comment the above two lines and uncomment the next line to use biblatex-chicago.
% \printbibliography[heading=bibintoc]

% Finally, an index would go here... but it is also optional.
\end{document}
